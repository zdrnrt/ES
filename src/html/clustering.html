<div class="page__content page-content">
  <header class="page-content__header">
    <p>Кластеризация</p>
  </header>
  <div class="clustering_container d-flex flex-column  ">
    <!-- Верхний блок с двумя колонками -->
    <div class="row flex-grow-1 border border-secondary-light  rounded-3 ml-0 mr-0 mb-3 border border-0">
      <!-- Левая колонка -->
      <div class="clustering_container d-flex flex-column">
        <!-- Верхний блок с тремя колонками -->
        <div class="row flex-grow-1 border border-secondary-light rounded-3 mx-0 mb-3">
          <!-- Новый левый столбец с селектами -->
          <div class="col-3 d-flex">
            <div class="column p-4 d-flex flex-column gap-3 w-100">
              <p class="card-title block_title mb-2 fs-4">Разрез кластеризации</p>
              
              <div class="form-group mb-0">
                <label for="param1" class="form-label">Регион</label>
                <select class="form-select form-select-sm mb-0" id="param1">
                  <option value="" disabled>Не используется</option>
                  <option value="norming_region1" disabled>Центральный</option>
                  <option value="norming_region2">Уральский ФО</option>
                  <option value="norming_region3" disabled>
                    Северо-западный
                  </option>
                  <option value="norming_region4" disabled>
                    Дальневосточный
                  </option>
                </select>
              </div>
              
              <div class="form-group mb-0">
                <label for="param2" class="form-label">Область</label>
                <select class="form-select form-select-sm mb-0" id="param2">
                  <option value="norming_area1" disabled>Все</option>
                  <option value="norming_area2" selected>Челябинская</option>
                  <option value="norming_area3" disabled>Свердловская</option>
                  <option value="norming_area4" disabled>Тюменская</option>
                  <option value="norming_area5" disabled>Курганская</option>
                </select>
              </div>
              
              <div class="form-group mb-0">
                <label for="param3" class="form-label">Формат магазина</label>
                <select class="form-select form-select-sm mb-0 " id="param3">
                  <option value="Все" disabled>Все</option>
                  <option value="Конвиниенс" disabled>Конвиниенс</option>
                  <option value="Супермаркеты" disabled>Супермаркеты</option>
                  <option value="Торговля через прилавок" selected>
                    Торговля через прилавок
                  </option>
                  <option value="Гипермаркеты" disabled>Гипермаркеты</option>
                  <option value="Дискаунтеры" disabled>Дискаунтеры</option>
                  <option value="Киоски" disabled>Киоски</option>
                  <option value="Алкомаркеты" disabled>Алкомаркеты</option>
                  <option value="Бирбутики" disabled>Бирбутики</option>
                </select>
              </div>
              
              <!-- <div class="form-group">
                <label for="param4" class="form-label">Параметр 4</label>
                <select class="form-select" id="param4">
                  <option value="1">Вариант 1</option>
                  <option value="2">Вариант 2</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="param5" class="form-label">Параметр 5</label>
                <select class="form-select" id="param5">
                  <option value="1">Вариант 1</option>
                  <option value="2">Вариант 2</option>
                </select>
              </div> -->
            </div>
          </div>
          
          <!-- Существующий левый столбец (уменьшил с col-4 на col-3) -->
          <div class="col-3 d-flex">
            <div class="column p-4 d-flex flex-column gap-3 w-100">
              <p class="card-title block_title mb-2 fs-4">Выбор алгоритма кластеризации</p>
      
              <div class="form-group row d-flex justify-content-between align-items-center w-100 mb-0">
                <div class="col-auto">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="radio" id="radioHandleClustering" name="clasteringVariants" value="manual_stratification" onchange="formParameterValue(this); toggleStratificationView(this)" />
                      Ручная стратификация
                    </label>
                  </div>
                </div>
              </div>
      
              <div class="form-group row d-flex justify-content-between align-items-center w-100 mb-0">
                <div class="col-auto">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" id="radioKmeansClustering" type="radio" name="clasteringVariants" value="kmeans" onchange="formParameterValue(this); toggleStratificationView(this)" checked />
                      K-means
                    </label>
                  </div>
                </div>
                <div class="col-auto">
                  <input type="text" id="clusteringKmeansQwCluster" class="form-control form-control--value" name="clasteringVariantsValue" value="5" />
                </div>
              </div>
      
              <div class="form-group row d-flex justify-content-between align-items-center w-100 mb-0">
                <div class="col-auto">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" id="radioDBSCANClustering" type="radio" name="clasteringVariants" value="dbscan" onchange="formParameterValue(this); toggleStratificationView(this)" />
                      DBSCAN
                    </label>
                  </div>
                </div>
              </div>
              <button class="btn btn-outline-primary">Сохранить выбор</button>
            </div>
          </div>
      
          <!-- Правая колонка (уменьшил с col-6 на col-5) -->
          <div class="col-5 d-flex">
            <div class="column p-4 flex-column gap-3 w-100 clustering_strats">
              <p class="card-title block_title mb-2 fs-4">Страты магазинов</p>
              
              <div class="row">
                <!-- Столбцы с чекбоксами -->
                <div class="col-md-4">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="clusteringAll" name="clusteringAll" onclick="toggleAllCheckboxes(this)" checked />
                      Все
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="clasteringSquare" name="clasteringSquare" onclick="handleChildCheckbox(this)" />
                      Площадь магазина
                    </label>
                  </div>
                </div>
                
                <div class="col-md-4">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="clasteringTools" name="clasteringTools" onclick="handleChildCheckbox(this)" />
                      Оборудование
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="clasteringTraf" name="clasteringTraf" onclick="handleChildCheckbox(this)" />
                      Трафик
                    </label>
                  </div>
                </div>
                
                <div class="col-md-4">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="clasteringCompetitors" name="clasteringCompetitors" onclick="handleChildCheckbox(this)" />
                      Сила конкурента
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="clasteringFormat" name="clasteringFormat" onclick="handleChildCheckbox(this)" />
                      Тип торговли
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      
        <!-- Блок с кнопками в правом нижнем углу -->
        <div class="d-flex justify-content-end mt-auto">
          <button type="button" class="btn btn-primary" onclick="buttonToggleLoading(this); setTimeout(() => { buttonToggleLoading(this); createClusters(); }, 2000)">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            Сформировать кластеры
          </button>
        </div>
    </div>
  
      <!-- Правая колонка -->

     
    </div>
    </div>
  

    <div class="border border-secondary-light  rounded-3 p-3 mb-3 mt-5">
      <p class="card-title block_title mb-2 fs-4">Показатели качества кластеров</p>
      <div class="d-flex">
        <div class="col-6">
          <div class="input-group input-group-sm mb-3">
            <span class="input-group-text" id="inputGroup-sizing-sm" data-bs-container="body" data-bs-toggle="popover" data-bs-placement="right" data-bs-content="Оценивает отношение дисперсии между кластерами к дисперсии внутри кластеров. Чем выше значение, тем лучше">Variance Ratio Criterion</span>
            <input type="text" id="varianceRatioCriterion" class="form-control" aria-describedby="inputGroup-sizing-sm" value="0">
          </div>
        </div>
        <div class="col-6">
          <div class="input-group input-group-sm mb-3">
            <span class="input-group-text" id="inputGroup-sizing-sm" data-bs-container="body" data-bs-toggle="popover" data-bs-placement="right" data-bs-content="Оценивает среднее отношение внутрикластерного расстояния к межкластерному расстоянию. Чем ниже значение, тем лучше">Davies-Bouldin Index</span>
            <input type="text" id="daviesBouldinIndex" class="form-control" aria-label="Пример размера поля ввода" aria-describedby="inputGroup-sizing-sm" value="0">
          </div>
        </div>
      </div>
    </div> 
    <div class ="alertClusteringNotParameters"></div>


    <div class="column clustering_bottom">
      <div class="col-12">
        <div class="d-flex justify-content-end align-items-center gap-2 mb-2">
          <select class="form-select p-1" aria-label="Пример выбора по умолчанию">
            <option selected>ось X</option>
            <option value="1">Продажи</option>
          </select>
          <select class="form-select p-1" aria-label="Пример выбора по умолчанию">
            <option selected>ось Y</option>
            <option value="1">Продажи</option>
            <option value="2">Фейсинги</option>
            <option value="3">SKU</option>
          </select>
          <select class="form-select p-1" aria-label="Пример выбора по умолчанию">
            <option selected>ось Z</option>
            <option value="1">Продажи</option>
            <option value="2">Фейсинги</option>
            <option value="3">SKU</option>
          </select>
        </div>
        <canvas id="clusteringChart" style="max-height: 500px"></canvas>
        <canvas id="clusteringChartBar" style="max-height: 300px; display: none;"></canvas>
      </div>

      <div class="col-12 p-0 overflow-auto">
        <!-- <div class="d-flex justify-content-end align-items-center gap-2 mb-2">
          <button
            type="button"
            class="btn btn-outline-primary btn-color-primary"
          >
            <i class="bi bi-upload"></i>
          </button>
          <button type="button" class="btn btn-primary">
            <i class="bi bi-save"></i>
          </button>
        </div> -->
        <div
          class="table border-bottom"
          style="padding-top: 9px; height: 300px"
        >
          <table class="table__table">
            <thead>
              <tr>
                <th>ID кластера</th>
                <th>ID магазина</th>
                <th>Центр кластера</th>
                <th>Расстояние до центра кластера</th>
                <th>Формат</th>
                <th>Адрес</th>
  
                <th>Нормализация</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Кластер1</td>
                <td>******30</td>
                <td>14,23</td>
                <td>8,3</td>
                <td>А1</td>
                <td>Ириновский пр. 24 корп C</td>
      
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******16</td>
                <td>14,23</td>
                <td>2,5</td>
                <td>А1</td>
                <td>СПб , Марата ул. 25</td>
      
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******36</td>
                <td>14,23</td>
                <td>1,9</td>
                <td>А1</td>
                <td>Спб, Шпалерная, 49</td>
      
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******31</td>
                <td>14,23</td>
                <td>13</td>
                <td>А1</td>
                <td>******36, Левый пер 1, стр1</td>
      
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******28</td>
                <td>14,23</td>
                <td>3,2</td>
                <td>А1</td>
                <td>Санкт –Петербург, Невский пр, 25</td>
      
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******36</td>
                <td>14,23</td>
                <td>1,2</td>
                <td>С3</td>
                <td>******36, ул. К.Заслонова, д.19 лит.Б</td>
  
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******46</td>
                <td>14,23</td>
                <td>3,6</td>
                <td>С3</td>
                <td>пр. М.Тореза ул., д. 105</td>
   
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******35</td>
                <td>14,23</td>
                <td>17,1</td>
                <td>С3</td>
                <td>Звенигородская улица, 36</td>
  
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******01</td>
                <td>14,23</td>
                <td>23,5</td>
                <td>С3</td>
                <td>г. ******36, Красное село, пр Ленина, 15</td>
      
                <td>auto</td>
              </tr>
              <tr>
                <td>Кластер1</td>
                <td>******36</td>
                <td>14,23</td>
                <td>14,2</td>
                <td>С3</td>
                <td>СПб, г.Колпино, Звездная ул., д. 86, лит. Б</td>
       
                <td>auto</td>
              </tr>
              <tr></tr>
            </tbody>
          </table>
        </div>

        <button class="btn btn-primary me-2" onclick="buttonToggleLoading(this); setTimeout(() => buttonToggleLoading(this), 2000)">
          Сохранить разметку магазинов
        </button>
      </div>
    </div>

    


  </div>

<!-- </div> -->
